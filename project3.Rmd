---
title: "project3"
output:
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
setwd("~/Uni/3rd Year/Data Analysis and Modelling/Project 3/tennis")
library(readxl)
library(EloRating)
my_data <- read_excel("data.xlsx")
```

```{r}
library(dplyr)
```

```{r}
library(EloRating)
library(zoo)
library(sna)
library(network)
library(Rcpp)
library(RcppArmadillo)
library(knitr)
library(Rdpack)
```
subset cleaned data into year groups
```{r}
date <- my_data$Date
winner <- my_data$Winner
loser <- my_data$Loser
```

begin data analysis 
```{r}
res <- elo.seq(winner, loser, date, startvalue = 1500,  runcheck = FALSE)
summary(res)
```
```{r}
table(my_data$Series)
myk <- list( "ATP250" = 20, "ATP500" = 20, "Grand Slam" = 40, "International" = 20, "International Gold" = 20, "Masters"= 20, "Masters 1000" = 20, "Masters Cup" = 178)
resk <- elo.seq(winner, loser, date, startvalue = 1500, intensity = my_data$Series, k = myk,  runcheck = FALSE)
summary(resk)
```

optimal k = 37.13131
```{r}
resok <- elo.seq(winner, loser, date, startvalue = 1500, k = 37.13131,  runcheck = FALSE)
correctly_predicted(resok)
```


subsetting the data into its year groups
```{r}
res2006 <- subset(res, Date >= "2006-01-01" & Date <= "2006-12-31")
res2007 <- subset(res, Date >= "2007-01-01" & Date <= "2007-12-31")
res2008 <- subset(res, Date >= "2008-01-01" & date <= "2008-12-31")
res2009 <- subset(res, Date >= "2009-01-01" & date <= "2009-12-31")
res2010 <- subset(res, Date >= "2010-01-01" & date <= "2010-12-31")
res2011 <- subset(res, Date >= "2011-01-01" & date <= "2011-12-31")
res2012 <- subset(res, Date >= "2012-01-01" & date <= "2012-12-31")
res2013 <- subset(res, Date >= "2013-01-01" & date <= "2013-12-31")
res2014 <- subset(res, Date >= "2014-01-01" & date <= "2014-12-31")
res2015 <- subset(res, Date >= "2015-01-01" & date <= "2015-12-31")
res2016 <- subset(res, Date >= "2016-01-01" & date <= "2016-12-31")
res2017 <- subset(res, Date >= "2017-01-01" & date <= "2017-12-31")
```
now we have all the subsetted data by year and elo ratings for each year.

2006 top 5
```{r}
elo2006<- extract_elo(res, extractdate = "2006-12-31",)
top2006 <- elo2006[1:5]
top2006
```
2007 top 5
```{r}
elo2007<- extract_elo(res, extractdate = "2007-12-31",)
top2007 <- elo2007[1:5]
top2007
```
2008 top 5 
```{r}
elo2008<- extract_elo(res, extractdate = "2008-12-31",)
top2008 <- elo2008[1:5]
top2008
```
2009 top 5
```{r}
elo2009<- extract_elo(res, extractdate = "2009-12-31",)
top2009 <- elo2009[1:5]
top2009
```
2010 top 5
```{r}
elo2010<- extract_elo(res, extractdate = "2010-12-31",)
top2010 <- elo2010[1:5]
top2010
```
2011 top 5
```{r}
elo2011<- extract_elo(res, extractdate = "2011-12-31",)
top2011 <- elo2011[1:5]
top2011
```
2012 top 5
```{r}
elo2012<- extract_elo(res, extractdate = "2012-12-31",)
top2012 <- elo2012[1:5]
top2012
```
2013 top 5 
```{r}
elo2013<- extract_elo(res, extractdate = "2013-12-31",)
top2013 <- elo2013[1:5]
top2013
```
2014 top 5
```{r}
elo2014<- extract_elo(res, extractdate = "2014-12-31",)
top2014 <- elo2014[1:5]
top2014
```
2015 top 5
```{r}
elo2015<- extract_elo(res, extractdate = "2015-12-31",)
top2015 <- elo2015[1:5]
top2015
```
2016 top 5 
```{r}
elo2016<- extract_elo(res, extractdate = "2016-12-31",)
top2016 <- elo2016[1:5]
top2016
```
Now that we know the individuals who have been in the top 5 at the end of each year, make them part of their own set.
```{r}
elo2017<- extract_elo(res, extractdate = "2017-11-19",)
top2017 <- elo2017[1:5]
top2017
```

```{r}
library(elo)
```

surface specific 
```{r}
hard <- filter(my_data, Surface == "Hard")
grass <- filter(my_data, Surface == "Grass")
clay <-filter(my_data, Surface == "Clay")
```
elo surface specific
```{r}
grassres <- elo.seq(winner = grass$Winner, loser = grass$Loser , Date = grass$Date, startvalue=1500, runcheck = F)
clayres <- elo.seq(winner = clay$Winner, loser = clay$Loser , Date = clay$Date, startvalue=1500, runcheck = F)
hardres <- elo.seq(winner = hard$Winner, loser = hard$Loser , Date = hard$Date, startvalue=1500, runcheck = F)
```
now for adjusted k
```{r}
grassresk <- elo.seq(winner = grass$Winner, loser = grass$Loser , Date = grass$Date, startvalue=1500, intensity = grass$Series, k = myk, runcheck = F)
clayresk <- elo.seq(winner = clay$Winner, loser = clay$Loser , Date = clay$Date, startvalue=1500, intensity = clay$Series, k = myk, runcheck = F)
hardresk <- elo.seq(winner = hard$Winner, loser = hard$Loser , Date = hard$Date, startvalue=1500, intensity = hard$Series, k = myk, runcheck = F)
```
now for new predictions:
```{r}
correctly_predicted(grassresk)
correctly_predicted(clayresk)
correctly_predicted(hardresk)
```
now optimal k for grass
```{r}
grassresok <- elo.seq(winner = grass$Winner, loser = grass$Loser , Date = grass$Date, startvalue=1500, k = 75, runcheck = F)
correctly_predicted(grassresok)
```
now optimal k for hard
```{r}
hardresok <- elo.seq(winner = hard$Winner, loser = hard$Loser , Date = hard$Date, startvalue=1500, k = 43, runcheck = F)
correctly_predicted(hardresok)
```
optimal clay
```{r}
clayresok <- elo.seq(winner = clay$Winner, loser = clay$Loser , Date = clay$Date, startvalue=1500, k = 53, runcheck = F)
correctly_predicted(clayresok)
```


summary of them
```{r}
summary(grassres)
summary(clayres)
summary(hardres)
```

```{r}
correctly_predicted(grassres)
correctly_predicted(hardres)
correctly_predicted(clayres)
```
plots of top 5 from each year over time

```{r}

plot1 <- eloplot(res,  ids = c("Murray A." , "Nadal R." , "Djokovic N." , "Cilic M." , "Tsonga J.W." , "Federer R."  , "Wawrinka S." , "Nishikori K." , "Ferrer D." , "Blake J.") ,  interpolate = "yes",  from = "start",  to = "end",  color = TRUE)
plot2 <- eloplot(res, ids = c("Del Potro J.M." , "Dimitrov G." , "Berdych T." , "Monfils G." , "Soderling R." , "Davydenko N." , "Nalbandian D." , "Karlovic I." , "Gasquet R." ,  "Gonzalez F.") , interpolate = "yes", from = "start",  to = "end",  color = TRUE)
```
Now top 20 from end of 2017
```{r}
elo2017<- extract_elo(res, extractdate = "2017-11-19",)
top2017 <- elo2017[1:20]
top2017
```
surface specific for the year 2017
```{r}
h17res <- extract_elo(hardres, extractdate = "2017-11-19",)
sortedh17res <- h17res[sort(names(h17res))]
g17res <- extract_elo(grassres, extractdate = "2017-07-23",)
sortedg17res <- g17res[sort(names(g17res))]
c17res <- extract_elo(clayres, extractdate = "2017-08-05",)
sortedc17res <- c17res[sort(names(c17res))]
```


Now look at elo for top 20 from each
```{r}
h17t20 <- extract_elo(hardres, extractdate = "2017-11-19", IDs = c("Federer R." , "Nadal R." , "Dimitrov G." , "Djokovic N." , "Del Potro J.M." , "Goffin D." , "Soderling R." , "Sock J." , "Kyrgios N." , "Wawrinka S." , "Blake J." , "Kohlschreiber P." , "Murray A." , "Isner J." , "Zverev A." , "Tsonga J.W." , "Pouille L." , "Bautista R." , "Nishikori K." , "Mannarino A." ,  "Dzumhur D."))
h17t20
```
now for grass
```{r}
g17t20 <- extract_elo(grassres, extractdate = "2017-07-23", IDs = c("Federer R." , "Nadal R." , "Dimitrov G." , "Djokovic N." , "Del Potro J.M." , "Goffin D." , "Soderling R." , "Sock J." , "Kyrgios N." , "Wawrinka S." , "Kohlschreiber P." , "Murray A." , "Isner J." , "Zverev A." , "Tsonga J.W." , "Pouille L." , "Bautista R." , "Nishikori K." , "Mannarino A." ,  "Dzumhur D."))
g17t20
```
now for clay
```{r}
c17t20 <- extract_elo(clayres, extractdate = "2017-08-05", IDs = c("Federer R." , "Nadal R." , "Dimitrov G." , "Djokovic N." , "Del Potro J.M." , "Goffin D." , "Soderling R." , "Sock J." , "Kyrgios N." , "Wawrinka S." , "Blake J." , "Kohlschreiber P." , "Murray A." , "Isner J." , "Zverev A." , "Tsonga J.W." , "Pouille L." , "Bautista R." , "Nishikori K." , "Mannarino A." ,  "Dzumhur D."))
c17t20
```

okay so now tryong to make the adjusted elo results 
```{r}
e2017all <- extract_elo(res, extractdate = "2017-11-19",)
e2017all <- e2017all[sort(names(e2017all))]
finalelo17 <- data.frame(e2017all)
```
so now i need to get the 747 individuals from hard elo scores.
```{r}
e2017 <- extract_elo(res, extractdate = "2017-11-19", IDs = hardres$allids)
e2017 <- e2017[sort(names(e2017))]
he2017 <- extract_elo(hardres, extractdate = "2017-11-19")
he2017 <- he2017[sort(names(he2017))]
adjhelo2017 <- (e2017*0.5)+(he2017*0.5)
adjH <- data.frame(adjhelo2017)
```

now for the 465 in grass
```{r}
e2017 <- extract_elo(res, extractdate = "2017-11-19", IDs = grassres$allids)
e2017 <- e2017[sort(names(e2017))]
ge2017 <- extract_elo(grassres, extractdate = "2017-07-23")
ge2017 <- ge2017[sort(names(ge2017))]
adjgelo2017 <- (e2017*0.5)+(ge2017*0.5)
adjg <- data.frame(adjgelo2017)
```


now for the 645 in clay
```{r}
e2017 <- extract_elo(res, extractdate = "2017-11-19", IDs = clayres$allids)
e2017 <- e2017[sort(names(e2017))]
ce2017 <- extract_elo(clayres, extractdate = "2017-08-05")
ce2017 <- ce2017[sort(names(ce2017))]
adjcelo2017 <- (e2017*0.5)+(ce2017*0.5)
adjc <- data.frame(adjcelo2017)
```
 
hard for australian open
```{r}
AOhardElo <- extract_elo(hardres, extractdate = "2017-11-19", IDs = c("Albot R." , "Anderson K." ,
"Bachinger M." ,
"Baghdatis M." ,
"Basilashvili N." ,
"Bautista Agut R." ,
"Bedene A." , 
"Bemelmans R.",
"Benneteau J.",
"Berankis R.",
"Berdych T.",
"Bhambri Y.", 
"Bolt A." ,
"Brown D." ,
"Carreno Busta P." ,
"Chardy J.",
"Chung H.",
"Cilic M." , 
"Copil M.", 
"Coric B." , 
"Cuevas P." ,
"Del Potro J.M." , 
"Dimitrov G." , 
"Djere L." ,
"Djokovic N." , 
"Dolgopolov O." , 
"Donaldson J." ,
"Donskoy E." , 
"Dutra Silva R." , 
"Dzumhur D." ,
"Ebden M." , 
"Edmund K." , 
"Estrella Burgos V." ,
"Fabbiano T." ,
"Federer R." ,
"Ferrer D." ,
"Fognini F." , 
"Fucsovics M." ,
"Garcia-Lopez G." ,
"Gasquet R." ,
"Goffin D." ,
"Gojowczyk P." ,
"Haase R." ,
"Haider-Maurer A." ,
"Halys Q." ,
"Harrison R." ,
"Herbert P.H." ,
"Isner J." ,
"Istomin D." ,
"Jarry N." ,
"Jaziri M." ,
"Johnson S." ,
"Karlovic I." ,
"Kavcic B." ,
"Khachanov K." ,
"Kicker N." ,
"King K." ,
"Kohlschreiber P." ,
"Kokkinakis T." ,
"Kubler J." ,
"Kudla D." ,
"Kukushkin M." ,
"Kyrgios N." , 
"Lacko L." ,
"Lajovic D." ,
"Lopez F." ,
"Lorenzi P." ,
"Mannarino A." ,
"Marterer M." ,
"Mayer F." ,
"Mayer L." ,
"Mcdonald M." ,
"Medvedev D." ,
"Melzer G." ,
"Millman J." ,
"Monfils G." ,
"Muller G." ,
"Nadal R." ,
"Nishioka Y." ,
"Novak D." ,
"Paire B." ,
"Pella G." ,
"Polansky P." ,
"Pospisil V." ,
"Pouille L." ,
"Querrey S." ,
"Ramos-Vinolas A." ,
"Raonic M." ,
"Rublev A." ,
"Ruud C." ,
"Safranek V." ,
"Sandgren T." ,
"Schwartzman D." ,
"Sela D." ,
"Seppi A." ,
"Shapovalov D." ,
"Simon G." ,
"Smyczek T." ,
"Sock J." ,
"Sousa J." ,
"Stebe C.M." ,
"Struff J.L." ,
"Sugita Y." ,
"Thiem D." ,
"Thompson J." ,
"Tiafoe F." ,
"Troicki V." ,
"Tsitsipas S." , 
"Tsonga J.W." ,
"Verdasco F." ,
"Vesely J." ,
"Wawrinka S." , 
"Ymer E." ,
"Young D." , 
"Youzhny M." ,
"Zeballos H." ,
"Zverev A." ,
"Zverev M."))

AOhardElo <- AOhardElo[sort(names(AOhardElo))]
AOhardElo
```

reg elo for AO
```{r}
AOElo <- extract_elo(res, extractdate = "2017-11-19", IDs = c("Albot R." , "Anderson K." ,
"Bachinger M." ,
"Baghdatis M." ,
"Basilashvili N." ,
"Bautista Agut R." ,
"Bedene A." , 
"Bemelmans R.",
"Benneteau J.",
"Berankis R.",
"Berdych T.",
"Bhambri Y.", 
"Bolt A." ,
"Brown D." ,
"Carreno Busta P." ,
"Chardy J.",
"Chung H.",
"Cilic M." , 
"Copil M.", 
"Coric B." , 
"Cuevas P." ,
"Del Potro J.M." , 
"Dimitrov G." , 
"Djere L." ,
"Djokovic N." , 
"Dolgopolov O." , 
"Donaldson J." ,
"Donskoy E." , 
"Dutra Silva R." , 
"Dzumhur D." ,
"Ebden M." , 
"Edmund K." , 
"Estrella Burgos V." ,
"Fabbiano T." ,
"Federer R." ,
"Ferrer D." ,
"Fognini F." , 
"Fucsovics M." ,
"Garcia-Lopez G." ,
"Gasquet R." ,
"Goffin D." ,
"Gojowczyk P." ,
"Haase R." ,
"Haider-Maurer A." ,
"Halys Q." ,
"Harrison R." ,
"Herbert P.H." ,
"Isner J." ,
"Istomin D." ,
"Jarry N." ,
"Jaziri M." ,
"Johnson S." ,
"Karlovic I." ,
"Kavcic B." ,
"Khachanov K." ,
"Kicker N." ,
"King K." ,
"Kohlschreiber P." ,
"Kokkinakis T." ,
"Kubler J." ,
"Kudla D." ,
"Kukushkin M." ,
"Kyrgios N." , 
"Lacko L." ,
"Lajovic D." ,
"Lopez F." ,
"Lorenzi P." ,
"Mannarino A." ,
"Marterer M." ,
"Mayer F." ,
"Mayer L." ,
"Mcdonald M." ,
"Medvedev D." ,
"Melzer G." ,
"Millman J." ,
"Monfils G." ,
"Muller G." ,
"Nadal R." ,
"Nishioka Y." ,
"Novak D." ,
"Paire B." ,
"Pella G." ,
"Polansky P." ,
"Pospisil V." ,
"Pouille L." ,
"Querrey S." ,
"Ramos-Vinolas A." ,
"Raonic M." ,
"Rublev A." ,
"Ruud C." ,
"Safranek V." ,
"Sandgren T." ,
"Schwartzman D." ,
"Sela D." ,
"Seppi A." ,
"Shapovalov D." ,
"Simon G." ,
"Smyczek T." ,
"Sock J." ,
"Sousa J." ,
"Stebe C.M." ,
"Struff J.L." ,
"Sugita Y." ,
"Thiem D." ,
"Thompson J." ,
"Tiafoe F." ,
"Troicki V." ,
"Tsitsipas S." , 
"Tsonga J.W." ,
"Verdasco F." ,
"Vesely J." ,
"Wawrinka S." , 
"Ymer E." ,
"Young D." , 
"Youzhny M." ,
"Zeballos H." ,
"Zverev A." ,
"Zverev M."))

AOElo <- AOElo[sort(names(AOElo))]
AOElo
```

PROPER AUSTRALIAN OPEN TESTING
fix ao data?
```{r}
aodata <- read_excel("AO.xlsx")
```
Now lets try to predict using whole elo score
```{r}
AOres1 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue = priorall, runcheck = FALSE)
```

now lets predict:
```{r}
correctly_predicted(AOres1)
```
plot the elos
```{r}
extract_elo(AOres1, extractdate = "2018-01-15", IDs = c("Cilic M."))
extract_elo(AOres1, extractdate = "2018-01-28", IDs = c("Cilic M."))
```

now for surface specific
```{r}
AOres2 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue = priorhard)
```
prediction:
```{r}
correctly_predicted(AOres2)

#0.675
#120
```
```{r}
extract_elo(AOres2, extractdate = "2018-01-15", IDs = c("Cilic M."))
extract_elo(AOres2, extractdate = "2018-01-28", IDs = c("Cilic M."))
```
adjusted elo stuff phi 0.5
```{r}
AOres3 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue = prior05, runcheck = FALSE )
```
predictions:
```{r}
#when phi = 0.5
correctly_predicted(AOres3)
```
for phi = 0.6
```{r}
AOres4 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue = prior06, runcheck = FALSE)
```
phi=0.6
```{r}
correctly_predicted(AOres4)
```
now phi=0.4
```{r}
AOres5 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue=prior04, runcheck = FALSE)
```
phi 0.4
```{r}
correctly_predicted(AOres5)
```
phi = 0.3
```{r}
AOres6 <- elo.seq(aodata$Winner, aodata$Loser, aodata$Date, startvalue=prior03)
```
prediction for 0.3
```{r}
correctly_predicted(AOres6)
```
can i make a data frame with correct starting values? lets see for total elo
```{r}
priorall <- c(2494, 
2403,
2357,
2345,
2280,
2239,
2177,
2128,
2106,
2091,
2081,
2079,
2076,
2068,
2057,
2052,
2047,
2036,
2030,
2026,
2024,
2018,
2018,
2001,
2000,
1965,
1959,
1951,
1951,
1941,
1930,
1929,
1919,
1917,
1911,
1890,
1889,
1888,
1885,
1881,
1880,
1877,
1871,
1859,
1853,
1852,
1850,
1845,
1839,
1838,
1835,
1832,
1832,
1829,
1828,
1822,
1816,
1815,
1799,
1797,
1795,
1792,
1790,
1789,
1781,
1765,
1758,
1745,
1743,
1742,
1739,
1734,
1717,
1714,
1713,
1712,
1710,
1707,
1705,
1694,
1690,
1686,
1677,
1672,
1664,
1656,
1647,
1639,
1639,
1622,
1598,
1597,
1580,
1552,
1549,
1549,
1519,
1500,
1500,
1500,
1500,
1500,
1495,
1491,
1490,
1488,
1486,
1462,
1452,
1441,
1428,
1418,
1414,
1406,
1406,
1404,
1403,
1402,
1397,
1377,
1371,
1362,
1351,
1290,
1266,
1250,
1196
) ; names(priorall) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Sock J." ,
"Kyrgios N." ,
"Wawrinka S." ,
"Kohlschreiber P." ,
"Isner J." ,
"Zverev A." , 
"Tsonga J.W." ,
"Pouille L." ,
"Bautista Agut R." ,
"Mannarino A." ,
"Dzumhur D." ,
"Raonic M." ,
"Cilic M." ,
"Gasquet R." ,
"Benneteau J." ,
"Fognini F.",
"Schwartzman D." ,
"Mayer L." ,
"Monfils G." ,
"Verdasco F." ,
"Chung H." ,
"Baghdatis M." ,
"Berdych T." ,
"Nishioka Y." ,
"Delbonis F." ,
"Ferrer D." ,
"Edmund K." ,
"Lopez F." ,
"Thiem D.",
"Istomin D." ,
"Haase R." ,
"Sela D." ,
"Muller G." ,
"Medvedev D." ,
"Dolgopolov O." ,
"Anderson K." ,
"Mayer F." ,
"Querrey S." ,
"Coric B." ,
"Sugita Y." ,
"Rublev A." ,
"Gojowczyk P." ,
"Troicki V." ,
"Paire B." ,
"Bemelmans R." ,
"Donaldson J." ,
"Pella G." ,
"Millman J." ,
"Struff J.L." ,
"Cuevas P." ,
"Bedene A." ,
"Harrison R." ,
"Thompson J." ,
"Berankis R." ,
"Karlovic I." ,
"Seppi A." ,
"Ramos-Vinolas A." ,
"Johnson S." ,
"Basilashvili N." ,
"Kokkinakis T." ,
"Sousa J." ,
"Carreno Busta P." ,
"Simon G." ,
"Ebden M." ,
"Zeballos H." ,
"Melzer G." ,
"Stebe C.M." ,
"Vesely J." ,
"Khachanov K." ,
"Kukushkin M." ,
"Lacko L." ,
"Dutra Silva R." ,
"Young D." ,
"Chardy J." ,
"Albot R." ,
"Brown D." ,
"Haider-Maurer A." ,
"Lajovic D." ,
"Garcia-Lopez G." ,
"Lorenzi P." ,
"Bachinger M." ,
"Copil M." ,
"Kicker N." ,
"Herbert P.H." ,
"Pospisil V." ,
"Estrella Burgos V." ,
"Jaziri M." ,
"Youzhny M." ,
"Daniel T." ,
"Smyczek T." ,
"Kudla D." ,
"Donskoy E." ,
"Kwon S.W." ,
"Moutet C." ,
"Popyrin A." ,
"Safranek V." ,
"Kavcic B." ,
"Berrettini M." ,
"Sonego L." ,
"Caruso S." ,
"Kubler J." ,
"King K." ,
"De Minaur A." ,
"Munar J." ,
"Tsitsipas S." ,
"Mcdonald M." ,
"Jarry N." ,
"Bolt A." ,
"Novak D." ,
"Djere L." ,
"Ruud C." ,
"Sandgren T." ,
"Halys Q." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Marterer M." ,
"Fucsovics M." ,
"Tiafoe F." ,
"Ymer E." ,
"Fabbiano T." ,
"Polansky P.")
```

now for, surface specific
```{r}
priorhard <- c(2418,
2291,
2265,
2261,
2196,
2137,
2101,
2100,
2083,
2079,
2035,
2016,
2000,
1999,
1992,
1988,
1983,
1972,
1965,
1949,
1943,
1929,
1926,
1900,
1894,
1889,
1885,
1849,
1837,
1823,
1818,
1815,
1803,
1798,
1787,
1779,
1778,
1776,
1772,
1771,
1769,
1768,
1762,
1762,
1761,
1760,
1758,
1750,
1747,
1743,
1730,
1729,
1728,
1724,
1719,
1719,
1718,
1717,
1716,
1710,
1708,
1703,
1699,
1696,
1696,
1683,
1681,
1675,
1674,
1674,
1672,
1672,
1652,
1635,
1626,
1625,
1622,
1620,
1611,
1608,
1606,
1598,
1581,
1567,
1565,
1537,
1522,
1519,
1518,
1511,
1510,
1500,
1500,
1500,
1500,
1500,
1500,
1500,
1500,
1500,
1500,
1499,
1495,
1491,
1490,
1487,
1487,
1485,
1472,
1470,
1469,
1462,
1444,
1438,
1426,
1412,
1408,
1401,
1395,
1392,
1384,
1349,
1338,
1309,
1283,
1264,
1196) ; names(priorhard) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Wawrinka S." ,
"Sock J." ,
"Raonic M." ,
"Kyrgios N." ,
"Tsonga J.W." ,
"Monfils G." ,
"Zverev A." ,
"Pouille L." ,
"Dzumhur D." ,
"Bautista Agut R." ,
"Isner J." ,
"Kohlschreiber P." ,
"Fognini F.",
"Benneteau J." ,
"Gasquet R." ,
"Mannarino A." ,
"Schwartzman D." ,
"Cilic M." ,
"Verdasco F." ,
"Nishioka Y." ,
"Baghdatis M." ,
"Berdych T." ,
"Edmund K." ,
"Mayer L." ,
"Haase R." ,
"Chung H." ,
"Thiem D.",
"Ferrer D." ,
"Istomin D." ,
"Berankis R." ,
"Paire B." ,
"Donaldson J." ,
"Dolgopolov O." ,
"Anderson K." ,
"Struff J.L." ,
"Millman J." ,
"Gojowczyk P." ,
"Sela D." ,
"Querrey S." ,
"Coric B." ,
"Troicki V." ,
"Bemelmans R." ,
"Medvedev D." ,
"Harrison R." ,
"Cuevas P." ,
"Rublev A." ,
"Basilashvili N." ,
"Sugita Y." ,
"Lopez F." ,
"Pella G." ,
"Simon G." ,
"Seppi A." ,
"Karlovic I." ,
"Kukushkin M." ,
"Ramos-Vinolas A." ,
"Thompson J." ,
"Chardy J." ,
"Lacko L." ,
"Muller G." ,
"Johnson S." ,
"Young D." ,
"Zeballos H." ,
"Kokkinakis T." ,
"Sousa J." ,
"Brown D." ,
"Copil M." ,
"Carreno Busta P." ,
"Bedene A." ,
"Vesely J." ,
"Dutra Silva R." ,
"Jaziri M." ,
"Haider-Maurer A." ,
"Lajovic D." ,
"Youzhny M." ,
"Bachinger M." ,
"Garcia-Lopez G." ,
"Herbert P.H." ,
"Pospisil V." ,
"Mayer F." ,
"Lorenzi P." ,
"Stebe C.M." ,
"Donskoy E." ,
"Khachanov K." , 
"Kavcic B." ,
"Kudla D." ,
"Berrettini M." ,
"Caruso S." ,
"Daniel T." ,
"De Minaur A." ,
"Delbonis F." ,
"Kwon S.W." ,
"Moutet C." ,
"Munar J." ,
"Popyrin A." ,
"Sonego L." ,
"Safranek V." ,
"Smyczek T." ,
"Albot R." ,
"Kubler J." ,
"Djere L." ,
"Ebden M." ,
"Sandgren T." ,
"Mcdonald M." ,
"Melzer G." ,
"King K." ,
"Novak D." ,
"Estrella Burgos V." ,
"Tsitsipas S." ,
"Jarry N." ,
"Marterer M." ,
"Fucsovics M." ,
"Kicker N." ,
"Ruud C" ,
"Bolt A." ,
"Halys Q." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Fabbiano T." ,
"Tiafoe F." ,
"Ymer E." ,
"Polansky P.")
```


for adjusted with phi=0.5
```{r}
prior05 <- c(2456,
2347,
2311,
2303,
2238,
2188,
2139,
2104,
2104,
2060,
2056,
2040,
2034,
2032,
2032,
2023,
2020,
2008,
1992,
1991,
1987,
1985,
1972,
1965,
1930,
1918,
1915,
1912,
1900,
1887,
1878,
1864,
1857,
1854,
1839,
1826,
1825,
1824,
1818,
1814,
1810,
1808,
1807,
1804,
1804,
1799,
1799,
1799,
1793,
1791,
1790,
1788,
1788,
1779,
1776,
1776,
1756,
1755,
1755,
1751,
1749,
1736,
1731,
1726,
1720,
1718,
1716,
1715,
1711,
1707,
1703,
1699,
1697,
1693,
1679,
1670,
1666,
1656,
1649,
1642,
1631,
1627,
1620,
1616,
1615,
1602,
1602,
1601,
1597,
1591,
1583,
1580,
1525,
1522,
1521,
1520,
1515,
1510,
1503,
1500,
1500,
1500,
1500,
1496,
1495,
1494,
1488,
1476,
1471,
1466,
1446,
1445,
1444,
1434,
1433,
1420,
1399,
1399,
1391,
1387,
1380,
1363,
1355,
1280,
1277,
1275,
1196) ;  names(prior05) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Sock J." ,
"Wawrinka S." ,
"Kyrgios N." ,
"Raonic M." ,
"Tsonga J.W." ,
"Zverev A." ,
"Pouille L." ,
"Isner J." ,
"Kohlschreiber P." ,
"Bautista Agut R." ,
"Dzumhur D." ,
"Monfils G." ,
"Fognini F.",
"Mannarino A." ,
"Benneteau J." ,
"Gasquet R." ,
"Schwartzman D." ,
"Cilic M." ,
"Verdasco F." ,
"Baghdatis M." ,
"Nishioka Y." ,
"Mayer L." ,
"Berdych T." ,
"Chung H." ,
"Edmund K." ,
"Ferrer D." ,
"Thiem D.",
"Haase R." ,
"Istomin D." ,
"Dolgopolov O." ,
"Sela D." ,
"Anderson K." ,
"Lopez F." ,
"Medvedev D." ,
"Querrey S." ,
"Paire B." ,
"Coric B." ,
"Donaldson J." ,
"Gojowczyk P." ,
"Struff J.L." ,
"Millman J." ,
"Troicki V." ,
"Bemelmans R." ,
"Muller G." ,
"Rublev A." ,
"Berankis R." ,
"Sugita Y." ,
"Harrison R." ,
"Cuevas P." ,
"Pella G." ,
"Karlovic I." ,
"Basilashvili N." ,
"Seppi A." ,
"Thompson J." ,
"Ramos-Vinolas A." ,
"Johnson S." ,
"Simon G." ,
"Bedene A." ,
"Kokkinakis T." ,
"Mayer F." ,
"Sousa J." ,
"Delbonis F." ,
"Kukushkin M." ,
"Zeballos H." ,
"Lacko L." ,
"Carreno Busta P." ,
"Chardy J." ,
"Young D." ,
"Brown D." ,
"Vesely J." ,
"Dutra Silva R." ,
"Copil M." ,
"Haider-Maurer A." ,
"Lajovic D." ,
"Garcia-Lopez G." ,
"Bachinger M." ,
"Stebe C.M." ,
"Khachanov K." ,
"Ebden M." ,
"Melzer G." ,
"Herbert P.H." ,
"Jaziri M." ,
"Lorenzi P." ,
"Albot R." ,
"Pospisil V." ,
"Youzhny M." ,
"Daniel T." ,
"Smyczek T." ,
"Estrella Burgos V." ,
"Kicker N." ,
"Kudla D." ,
"Donskoy E." ,
"Kavcic B." ,
"Kwon S.W." ,
"Moutet C." ,
"Popyrin A." ,
"Safranek V." ,
"Berrettini M." ,
"Sonego L." ,
"Caruso S." ,
"Kubler J." ,
"De Minuar A." ,
"Munar J." ,
"King K." ,
"Djere L." ,
"Mcdonald M." ,
"Sandgren T." ,
"Novak D." ,
"Tsitsipas S." ,
"Jarry N." ,
"Ruud C" ,
"Bolt A." ,
"Halys Q." ,
"Marterer M." ,
"Fucsovics M." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Fabbiano T." ,
"Tiafoe F." ,
"Ymer E." ,
"Polansky P.")
```

for adjusted with phi=0.4
```{r}
prior04 <- c(2448,
2336,
2302,
2295,
2230,
2178,
2131,
2103,
2099,
2064,
2051,
2032,
2027,
2022,
2020,
2016,
2014,
2010,
1986,
1979,
1978,
1976,
1963,
1952,
1922,
1911,
1910,
1894,
1890,
1873,
1870,
1850,
1846,
1846,
1828,
1815,
1813,
1812,
1802,
1801,
1800,
1798,
1798,
1797,
1795,
1793,
1792,
1790,
1786,
1784,
1777,
1775,
1772,
1772,
1767,
1764,
1749,
1748,
1747,
1741,
1741,
1728,
1725,
1711,
1710,
1708,
1707,
1702,
1701,
1697,
1691,
1689,
1687,
1678,
1672,
1661,
1659,
1658,
1643,
1635,
1624,
1622,
1605,
1600,
1597,
1596,
1589,
1586,
1585,
1579,
1576,
1571,
1520,
1517,
1514,
1511,
1505,
1505,
1500,
1500,
1500,
1499,
1496,
1496,
1496,
1495,
1488,
1481,
1476,
1466,
1454,
1452,
1450,
1440,
1434,
1421,
1398,
1398,
1392,
1389,
1385,
1360,
1351,
1285,
1276,
1274,
1196
) ; names(prior04) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Sock J." ,
"Wawrinka S." ,
"Kyrgios N." ,
"Raonic M." ,
"Tsonga J.W." ,
"Zverev A." ,
"Pouille L." ,
"Isner J." ,
"Kohlschreiber P." ,
"Bautista Agut R." ,
"Dzumhur D." ,
"Monfils G." ,
"Fognini F.",
"Benneteau J." ,
"Mannarino A." ,
"Gasquet R." ,
"Schwartzman D." ,
"Cilic M." ,
"Verdasco F." ,
"Baghdatis M." ,
"Nishioka Y." ,
"Mayer L." ,
"Berdych T." ,
"Chung H." ,
"Edmund K." ,
"Ferrer D." ,
"Haase R." ,
"Thiem D.",
"Istomin D." ,
"Dolgopolov O." ,
"Anderson K." ,
"Sela D." ,
"Paire B." ,
"Medvedev D." ,
"Querrey S." ,
"Donaldson J." ,
"Lopez F." ,
"Coric B." ,
"Gojowczyk P." ,
"Struff J.L." ,
"Millman J." ,
"Troicki V." ,
"Berankis R." ,
"Bemelmans R." ,
"Rublev A." ,
"Sugita Y." ,
"Harrison R." ,
"Muller G." ,
"Cuevas P." ,
"Pella G." ,
"Basilashvili N." ,
"Karlovic I." ,
"Seppi A." ,
"Thompson J." ,
"Ramos-Vinolas A." ,
"Simon G." ,
"Johnson S." ,
"Kukushkin M." ,
"Kokkinakis T." ,
"Sousa J." ,
"Bedene A." ,
"Lacko L." ,
"Zeballos H." ,
"Chardy J." ,
"Young D." ,
"Carreno Busta P." ,
"Mayer F." ,
"Brown D." ,
"Delbonis F." ,
"Vesely J." ,
"Copil M." ,
"Dutra Silva R." ,
"Haider-Maurer A." ,
"Lajovic D." ,
"Garcia-Lopez G." ,
"Bachinger M." ,
"Jaziri M." ,
"Stebe C.M." ,
"Herbert P.H." ,
"Khachanov K." ,
"Ebden M." ,
"Youzhny M." ,
"Lorenzi P." ,
"Pospisil V." ,
"Melzer G." ,
"Albot R." ,
"Daniel T." ,
"Smyczek T." ,
"Kudla D." ,
"Donskoy E." ,
"Estrella Burgos V." ,
"Kavcic B." ,
"Kwon S.W." ,
"Moutet C." ,
"Popyrin A." ,
"Safranek V." ,
"Berrettini M." ,
"Kicker N." ,
"Sonego L." ,
"Caruso S." ,
"Kubler J." ,
"De Minuar A." ,
"Munar J." ,
"King K." ,
"Djere L." ,
"Sandgren T." ,
"Mcdonald M." ,
"Novak D." ,
"Tsitsipas S." ,
"Jarry N." ,
"Ruud C" ,
"Bolt A." ,
"Marterer M." ,
"Halys Q." ,
"Fucsovics M." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Fabbiano T." ,
"Ymer E." ,
"Tiafoe F." ,
"Polansky P.")
```

for adjusted with phi=0.6
```{r}
prior06 <- c(2464,
2358,
2320,
2311,
2246,
2198,
2146,
2108,
2104,
2060,
2055,
2047,
2043,
2042,
2040,
2029,
2025,
2006,
2003,
1997,
1994,
1993,
1981,
1978,
1937,
1930,
1925,
1920,
1910,
1901,
1886,
1877,
1868,
1861,
1849,
1838,
1838,
1837,
1835,
1827,
1820,
1816,
1814,
1812,
1810,
1809,
1807,
1805,
1804,
1802,
1801,
1801,
1790,
1787,
1786,
1785,
1763,
1762,
1761,
1760,
1758,
1757,
1749,
1747,
1744,
1733,
1729,
1724,
1713,
1711,
1708,
1704,
1696,
1695,
1680,
1679,
1674,
1654,
1652,
1648,
1640,
1639,
1638,
1635,
1631,
1628,
1610,
1608,
1606,
1597,
1586,
1574,
1544,
1536,
1529,
1527,
1515,
1508,
1501,
1500,
1500,
1500,
1500,
1495,
1494,
1493,
1488,
1471,
1465,
1465,
1440,
1437,
1435,
1432,
1428,
1419,
1400,
1400,
1392,
1382,
1374,
1366,
1358,
1280,
1274,
1273,
1196) ; names(prior06) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Sock J." ,
"Kyrgios N." ,
"Wawrinka S." ,
"Tsonga J.W." ,
"Raonic M." ,
"Zverev A." ,
"Kohlschreiber P." ,
"Isner J." ,
"Pouille L." ,
"Bautista Agut R." ,
"Dzumhur D." ,
"Monfils G." ,
"Mannarino A." ,
"Fognini F.",
"Benneteau J." ,
"Gasquet R." ,
"Schwartzman D." ,
"Cilic M." ,
"Verdasco F." ,
"Mayer L." ,
"Baghdatis M." ,
"Nishioka Y." ,
"Berdych T." ,
"Chung H." ,
"Edmund K." ,
"Ferrer D." ,
"Thiem D.",
"Haase R." ,
"Istomin D." ,
"Lopez F." ,
"Sela D." ,
"Dolgopolov O." ,
"Anderson K." ,
"Medvedev D." ,
"Querrey S." ,
"Coric B." ,
"Paire B." ,
"Gojowczyk P." ,
"Donaldson J." ,
"Muller G." ,
"Troicki V." ,
"Millman J." ,
"Struff J.L." ,
"Rublev A." ,
"Bemelmans R." ,
"Sugita Y." ,
"Berankis R." ,
"Pella G." ,
"Harrison R." ,
"Cuevas P." ,
"Karlovic I." ,
"Seppi A." ,
"Thompson J." ,
"Basilashvili N." ,
"Delbonis F." ,
"Ramos-Vinolas A." ,
"Mayer F." ,
"Johnson S." ,
"Bedene A." ,
"Simon G." ,
"Kokkinakis T." ,
"Sousa J." ,
"Zeballos H." ,
"Kukushkin M." ,
"Carreno Busta P." ,
"Lacko L." ,
"Chardy J." ,
"Young D." ,
"Brown D." ,
"Vesely J." ,
"Dutra Silva R." ,
"Haider-Maurer A." ,
"Copil M." ,
"Lajovic D." ,
"Ebden M." ,
"Stebe C.M." ,
"Garcia-Lopez G." ,
"Khachanov K." ,
"Bachinger M." ,
"Melzer G." ,
"Albot R." ,
"Lorenzi P." ,
"Herbert P.H." ,
"Jaziri M." ,
"Pospisil V." ,
"Youzhny M." ,
"Kicker N." ,
"Estrella Burgos V." ,
"Daniel T." ,
"Smyczek T." ,
"Kudla D." ,
"Donskoy E." ,
"Kavcic B." ,
"Kwon S.W." ,
"Moutet C." ,
"Popyrin A." ,
"Safranek V." ,
"Berrettini M." ,
"Sonego L." ,
"Caruso S." ,
"Kubler J." ,
"De Minuar A." ,
"King K." ,
"Munar J." ,
"Mcdonald M." ,
"Djere L." ,
"Sandgren T." ,
"Tsitsipas S." ,
"Novak D." ,
"Jarry N." ,
"Bolt A." ,
"Ruud C" ,
"Halys Q." ,
"Marterer M." ,
"Fucsovics M." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Tiafoe F." ,
"Fabbiano T." ,
"Ymer E." ,
"Polansky P.")
```

for adjusted with phi=0.3
```{r}
prior03 <- c(2441,
2325,
2293,
2286,
2221,
2168,
2123,
2103,
2094,
2069,
2047,
2024,
2020,
2012,
2011,
2009,
2009,
2008,
1981,
1972,
1968,
1966,
1954,
1939,
1915,
1905,
1905,
1880,
1876,
1862,
1858,
1839,
1837,
1835,
1818,
1804,
1803,
1800,
1796,
1793,
1790,
1788,
1787,
1787,
1787,
1786,
1784,
1782,
1778,
1776,
1765,
1765,
1762,
1758,
1753,
1753,
1744,
1740,
1740,
1733,
1732,
1726,
1715,
1711,
1701,
1700,
1699,
1698,
1694,
1689,
1688,
1680,
1676,
1662,
1657,
1652,
1650,
1637,
1629,
1629,
1618,
1618,
1609,
1593,
1591,
1581,
1577,
1576,
1573,
1564,
1551,
1549,
1515,
1513,
1513,
1511,
1506,
1500,
1500,
1500,
1499,
1497,
1497,
1496,
1490,
1489,
1486,
1482,
1472,
1467,
1462,
1460,
1456,
1445,
1435,
1422,
1397,
1397,
1396,
1391,
1388,
1357,
1348,
1291,
1278,
1272,
1196

) ; names(prior03) <- c("Federer R." ,
"Nadal R." ,
"Dimitrov G." ,
"Djokovic N." ,
"Del Potro J.M." ,
"Goffin D." ,
"Sock J." ,
"Wawrinka S." ,
"Kyrgios N." ,
"Raonic M." ,
"Tsonga J.W." ,
"Zverev A." ,
"Pouille L." ,
"Isner J." ,
"Monfils G." ,
"Bautista Agut R." ,
"Dzumhur D." ,
"Kohlschreiber P." ,
"Fognini F.",
"Benneteau J." ,
"Gasquet R." ,
"Mannarino A." ,
"Schwartzman D." ,
"Cilic M." ,
"Verdasco F." ,
"Baghdatis M." ,
"Nishioka Y." ,
"Berdych T." ,
"Mayer L." ,
"Edmund K." ,
"Chung H." ,
"Haase R." ,
"Ferrer D." ,
"Thiem D.",
"Istomin D." ,
"Dolgopolov O." ,
"Anderson K." ,
"Sela D." ,
"Paire B." ,
"Donaldson J." ,
"Querrey S." ,
"Coric B." ,
"Medvedev D." ,
"Gojowczyk P." ,
"Struff J.L." ,
"Millman J." ,
"Berankis R." ,
"Troicki V." ,
"Lopez F." ,
"Bemelmans R." ,
"Rublev A." ,
"Harrison R." ,
"Sugita Y." ,
"Cuevas P." ,
"Pella G." ,
"Muller G." ,
"Basilashvili N." ,
"Karlovic I." ,
"Seppi A." ,
"Ramos-Vinolas A." ,
"Thompson J." ,
"Simon G." ,
"Johnson S." ,
"Kukushkin M." ,
"Kokkinakis T." ,
"Lacko L." ,
"Sousa J." ,
"Chardy J." ,
"Zeballos H." ,
"Bedene A." ,
"Young D." ,
"Carreno Busta P." ,
"Brown D." ,
"Copil M." ,
"Mayer F." ,
"Vesely J." ,
"Dutra Silva R." ,
"Haider-Maurer A." ,
"Lajovic D." ,
"Delbonis F." ,
"Bachinger M." ,
"Garcia-Lopez G." ,
"Jaziri M." ,
"Herbert P.H." ,
"Youzhny M." ,
"Stebe C.M." ,
"Khachanov K." ,
"Pospisil V." ,
"Lorenzi P." ,
"Ebden M." ,
"Albot R." ,
"Melzer G." ,
"Daniel T." ,
"Donskoy E." ,
"Kudla D." ,
"Smyczek T." ,
"Kavcic B." ,
"Kwon S.W." ,
"Moutet C." ,
"Popyrin A." ,
"Safranek V." ,
"Berrettini M." ,
"Sonego L." ,
"Caruso S." ,
"Estrella Burgos V." ,
"Kubler J." ,
"De Minuar A." ,
"Munar J." ,
"Kicker N." ,
"King K." ,
"Djere L." ,
"Sandgren T." ,
"Mcdonald M." ,
"Novak D." ,
"Tsitsipas S." ,
"Jarry N." ,
"Ruud C" ,
"Marterer M." ,
"Bolt A." ,
"Fucsovics M." ,
"Halys Q." ,
"Shapovalov D." ,
"Bhambri Y." ,
"Fabbiano T." ,
"Ymer E." ,
"Tiafoe F." ,
"Polansky P.")
```


```

