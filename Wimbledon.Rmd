---
title: "wimbledon"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
so 
```{r}
setwd("~/Uni/3rd Year/Data Analysis and Modelling/Project 3/tennis")
library(readxl)
library(EloRating)
data <- read_excel("mydata.xlsx")
```
elo stuff
```{r}
res00 <- elo.seq(winner = data$Winner, loser = data$Loser, data$Date, startvalue = 1500, runcheck = FALSE)
summary(res00)
```
surfaces
```{r}
hard00 <- filter(data, Surface == "Hard")
grass00 <- filter(data, Surface == "Grass")
clay00 <-filter(data, Surface == "Clay")
```

isolate wimbledon IDs:
```{r}
wimbledon <- read_excel("Wimbledon.xlsx")
resw <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, runcheck = FALSE)
```

so now elo ratings from wimbledon players before competition
```{r}
q<-(extract_elo(res00, "2018-07-01", IDs = resw$allids))
q <- q[sort(names(q))]
q
```

now for just grass:
```{r}
resg <- elo.seq(grass00$Winner, grass00$Loser, grass00$Date, startvalue = 1500, runcheck = FALSE)
g<-(extract_elo(resg, "2018-07-01", IDs = resw$allids))
g <- g[sort(names(g))]
g
```



now to begin the modelling process:
```{r}
##start vals for all elo
sv <- c(1587,
1918,
1490,
1622,
1385,
1587,
1702,
1642,
1611,
1757,
1626,
1570,
1529,
1704,
1400,
1490,
1477,
1606,
1909,
1918,
1916,
2196,
1502,
1550,
2176,
1772,
1791,
1661,
2228,
1611,
1901,
1509,
2086,
1664,
1676,
1546,
1899,
1790,
1933,
1633,
1540,
2295,
1638,
1938,
1680,
1877,
1766,
1407,
1932,
1925,
1854,
1300,
1626,
1679,
1409,
1558,
1799,
1531,
1924,
1676,
1646,
1694,
1805,
1456,
1529,
1951,
1227,
1777,
1949,
1420,
1715,
1721,
2098,
1726,
1880,
1811,
1463,
1508,
1805,
1728,
1501,
1773,
1510,
1642,
1766,
1661,
1812,
1557,
2500,
2013,
1681,
1612,
1384,
1873,
1723,
1264,
1530,
1780,
1712,
1754,
2052,
1453,
1587,
1890,
1683,
1639,
1743,
1721,
1184,
1585,
1661,
1747,
1652,
1640,
1666,
1440,
1787,
1683,
1484,
1826,
1705,
1710,
1680,
1480,
1665,
2177,
1921
) ; names(sv) <- c(resw$allids)
```
for normal elo:
```{r}
resw1 <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, startvalue = sv, runcheck=FALSE)
correctly_predicted(resw1)
```

for grass elo:
```{r}
svg <- c(1559,
1702,
1500,
1598,
1500,
1416,
1536,
1614,
1513,
1591,
1292,
1431,
1482,
1621,
1502,
1500,
1348,
1446,
1459,
1565,
1785,
2217,
1467,
1526,
1704,
1596,
1351,
1446,
1712,
1319,
1795,
1500,
2176,
1412,
1369,
1461,
1752,
1725,
1513,
1401,
1464,
2136,
1549,
1635,
1337,
1496,
1498,
1475,
1810,
1730,
1583,
1461,
1560,
1598,
1500,
1313,
1544,
1500,
1773,
1637,
1438,
1388,
1686,
1445,
1614,
1736,
1378,
1595,
1490,
1500,
1609,
1600,
1969,
1561,
1494,
1905,
1225,
1483,
1745,
1435,
1631,
1583,
1545,
1647,
1584,
1500,
1728,
1762,
1791,
1788,
1460,
1473,
1500,
1733,
1501,
1500,
1475,
1691,
1928,
1588,
1999,
1418,
1449,
1275,
1690,
1598,
1453,
1551,
1336,
1663,
1500,
1514,
1628,
1354,
1602,
1407,
1570,
1740,
1459,
1525,
1569,
1624,
1654,
1513,
1232,
1759,
1822
) ; names(svg) <- c(resw$allids)
```
```{r}
resw2 <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, startvalue = svg, runcheck=FALSE)
correctly_predicted(resw2)
```

now for adjusted with 0.5:
```{r}
sva05 <- c(1573,
1810,
1495,
1610,
1442.5,
1501.5,
1619,
1628,
1562,
1674,
1459,
1500.5,
1505.5,
1662.5,
1451,
1495,
1412.5,
1526,
1684,
1741.5,
1850.5,
2206.5,
1484.5,
1538,
1940,
1684,
1571,
1553.5,
1970,
1465,
1848,
1504.5,
2131,
1538,
1522.5,
1503.5,
1825.5,
1757.5,
1723,
1517,
1502,
2215.5,
1593.5,
1786.5,
1508.5,
1686.5,
1632,
1441,
1871,
1827.5,
1718.5,
1380.5,
1593,
1638.5,
1454.5,
1435.5,
1671.5,
1515.5,
1848.5,
1656.5,
1542,
1541,
1745.5,
1450.5,
1571.5,
1843.5,
1302.5,
1686,
1719.5,
1460,
1662,
1660.5,
2033.5,
1643.5,
1687,
1858,
1344,
1495.5,
1775,
1581.5,
1566,
1678,
1527.5,
1644.5,
1675,
1580.5,
1770,
1659.5,
2145.5,
1900.5,
1570.5,
1542.5,
1442,
1803,
1612,
1382,
1502.5,
1735.5,
1820,
1671,
2025.5,
1435.5,
1518,
1582.5,
1686.5,
1618.5,
1598,
1636,
1260,
1624,
1580.5,
1630.5,
1640,
1497,
1634,
1423.5,
1678.5,
1711.5,
1471.5,
1675.5,
1637,
1667,
1667,
1496.5,
1448.5,
1968,
1871.5
) ; names(sva05) <- c(resw$allids)
```


```{r}
resw3 <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, startvalue = sva05, runcheck=FALSE)
correctly_predicted(resw3)
```
adjusted 0.6
```{r}
sva06 <- c(1570.2,
1788.4,
1496,
1607.6,
1454,
1484.4,
1602.4,
1625.2,
1552.2,
1657.4,
1425.6,
1486.6,
1500.8,
1654.2,
1461.2,
1496,
1399.6,
1510,
1639,
1706.2,
1837.4,
2208.6,
1481,
1535.6,
1892.8,
1666.4,
1527,
1532,
1918.4,
1435.8,
1837.4,
1503.6,
2140,
1512.8,
1491.8,
1495,
1810.8,
1751,
1681,
1493.8,
1494.4,
2199.6,
1584.6,
1756.2,
1474.2,
1648.4,
1605.2,
1447.8,
1858.8,
1808,
1691.4,
1396.6,
1586.4,
1630.4,
1463.6,
1411,
1646,
1512.4,
1833.4,
1652.6,
1521.2,
1510.4,
1733.6,
1449.4,
1580,
1822,
1317.6,
1667.8,
1673.6,
1468,
1651.4,
1648.4,
2020.6,
1627,
1648.4,
1867.4,
1320.2,
1493,
1769,
1552.2,
1579,
1659,
1531,
1645,
1656.8,
1564.4,
1761.6,
1680,
2074.6,
1878,
1548.4,
1528.6,
1453.6,
1789,
1589.8,
1405.6,
1497,
1726.6,
1841.6,
1654.4,
2020.2,
1432,
1504.2,
1521,
1687.2,
1614.4,
1569,
1619,
1275.2,
1631.8,
1564.4,
1607.2,
1637.6,
1468.4,
1627.6,
1420.2,
1656.8,
1717.2,
1469,
1645.4,
1623.4,
1658.4,
1664.4,
1499.8,
1405.2,
1926.2,
1861.6
) ; names(sva06) <- c(resw$allids)
```

```{r}
resw4 <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, startvalue = sva06, runcheck=FALSE)
correctly_predicted(resw4)
```

adj0.7
```{r}
sva07 <- c(1567.4,
1766.8,
1497,
1605.2,
1465.5,
1467.3,
1585.8,
1622.4,
1542.4,
1640.8,
1392.2,
1472.7,
1496.1,
1645.9,
1471.4,
1497,
1386.7,
1494,
1594,
1670.9,
1824.3,
2210.7,
1477.5,
1533.2,
1845.6,
1648.8,
1483,
1510.5,
1866.8,
1406.6,
1826.8,
1502.7,
2149,
1487.6,
1461.1,
1486.5,
1796.1,
1744.5,
1639,
1470.6,
1486.8,
2183.7,
1575.7,
1725.9,
1439.9,
1610.3,
1578.4,
1454.6,
1846.6,
1788.5,
1664.3,
1412.7,
1579.8,
1622.3,
1472.7,
1386.5,
1620.5,
1509.3,
1818.3,
1648.7,
1500.4,
1479.8,
1721.7,
1448.3,
1588.5,
1800.5,
1332.7,
1649.6,
1627.7,
1476,
1640.8,
1636.3,
2007.7,
1610.5,
1609.8,
1876.8,
1296.4,
1490.5,
1763,
1522.9,
1592,
1640,
1534.5,
1645.5,
1638.6,
1548.3,
1753.2,
1700.5,
2003.7,
1855.5,
1526.3,
1514.7,
1465.2,
1775,
1567.6,
1429.2,
1491.5,
1717.7,
1863.2,
1637.8,
2014.9,
1428.5,
1490.4,
1459.5,
1687.9,
1610.3,
1540,
1602,
1290.4,
1639.6,
1548.3,
1583.9,
1635.2,
1439.8,
1621.2,
1416.9,
1635.1,
1722.9,
1466.5,
1615.3,
1609.8,
1649.8,
1661.8,
1503.1,
1361.9,
1884.4,
1851.7
) ; names(sva07) <- c(resw$allids)
```


```{r}
resw5 <- elo.seq(wimbledon$Winner, wimbledon$Loser, wimbledon$Date, startvalue = sva07, runcheck=FALSE)
correctly_predicted(resw5)
```